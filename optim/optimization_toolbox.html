<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Presentation &#8212; MLPP 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="MLPP 0.1 documentation" href="../index.html" />
    <link rel="next" title="Models [mlpp.optim.model]" href="model.html" />
    <link rel="prev" title="Time functions" href="../z_tutorials/misc/time_function.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">MLPP 0.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../z_tutorials/misc/time_function.html" title="Time functions"
             accesskey="P">previous</a> |
          <a href="model.html" title="Models [mlpp.optim.model]"
             accesskey="N">next</a> |
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="presentation">
<h1>Presentation<a class="headerlink" href="#presentation" title="Permalink to this headline">¶</a></h1>
<p>We are in the following case</p>
<div class="math">
\[\min_x f(x) + g(x)\]</div>
<p>In which <span class="math">\(f\)</span> and <span class="math">\(g\)</span> are usually convex and <span class="math">\(g\)</span> is
prox-capable. Depending on the problem, you might want to use a specific
algorithm to solve it.</p>
<p>In mlpp:</p>
<ul class="simple">
<li>we call <span class="math">\(f\)</span> the <strong>model</strong>. The model gives information about a
statistical model based on the data our problem relies on.
Depending on the case, it gives first order information (loss, gradient) or
second order information (hessian related values).<ul>
<li>linear regression <a class="reference internal" href="model/linreg.html#mlpp.optim.model.ModelLinReg" title="mlpp.optim.model.ModelLinReg"><code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.model.ModelLinReg</span></code></a></li>
<li>logistic regression <a class="reference internal" href="model/logreg.html#mlpp.optim.model.ModelLogReg" title="mlpp.optim.model.ModelLogReg"><code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.model.ModelLogReg</span></code></a></li>
</ul>
</li>
<li>we call <span class="math">\(g\)</span> the <strong>prox</strong>. The prox will make our solution looks like
what we think it should.<ul>
<li>Prox L1 (or lasso) <a class="reference internal" href="prox/prox_l1.html#mlpp.optim.prox.ProxL1" title="mlpp.optim.prox.ProxL1"><code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.prox.ProxL1</span></code></a></li>
<li>Prox L2 (or ridge) <a class="reference internal" href="prox/prox_l2sq.html#mlpp.optim.prox.ProxL2Sq" title="mlpp.optim.prox.ProxL2Sq"><code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.prox.ProxL2Sq</span></code></a></li>
</ul>
</li>
<li>we call the algorithm the <strong>solver</strong>. The solver associated the model and
the prox use an algorithm to determine what is the minimizer of our problem.
Examples of solver are SGD (stochastic gradient descent), Fista or SVRG.<ul>
<li>SGD <a class="reference internal" href="solver/sgd.html#mlpp.optim.solver.SGD" title="mlpp.optim.solver.SGD"><code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.solver.SGD</span></code></a></li>
<li>Fista <a class="reference internal" href="solver/fista.html#mlpp.optim.solver.Fista" title="mlpp.optim.solver.Fista"><code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.solver.Fista</span></code></a></li>
<li>SVRG <a class="reference internal" href="solver/svrg.html#mlpp.optim.solver.SVRG" title="mlpp.optim.solver.SVRG"><code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.solver.SVRG</span></code></a></li>
</ul>
</li>
</ul>
<p>This allow us to try many different combinations of models, proximal operators
and solvers.</p>
<p>Here is a quick example of finding the result of a logistic regression with a
ridge penalization thanks to SVRG solver:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.model</span> <span class="k">import</span> <span class="n">ModelLogReg</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.solver</span> <span class="k">import</span> <span class="n">SVRG</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.prox</span> <span class="k">import</span> <span class="n">ProxL2Sq</span>
<span class="kn">from</span> <span class="nn">mlpp.simulation</span> <span class="k">import</span> <span class="n">SimuLogReg</span>

<span class="c1"># simulate logistic data</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SimuLogReg</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="c1"># create logistic model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ModelLogReg</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make model fits the data</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Create the prox L2</span>
<span class="n">l_l2sq</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">7</span>
<span class="n">prox</span> <span class="o">=</span> <span class="n">ProxL2Sq</span><span class="p">(</span><span class="n">l_l2sq</span><span class="p">)</span>

<span class="c1"># Create the solver</span>
<span class="n">svrg</span> <span class="o">=</span> <span class="n">SVRG</span><span class="p">(</span><span class="n">print_every</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Make solver work with our model and prox</span>
<span class="n">svrg</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svrg</span><span class="o">.</span><span class="n">set_prox</span><span class="p">(</span><span class="n">prox</span><span class="p">)</span>

<span class="c1"># Find the solution</span>
<span class="n">minimizer</span> <span class="o">=</span> <span class="n">svrg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">n_coeffs</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">found minimizer</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">minimizer</span><span class="p">)</span>
</pre></div>
</div>
<p>This outputs:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Launching the solver SVRG...
  n_iter  |    obj    |  rel_obj
        0 |  2.57e-01 |  6.29e-01
        3 |  2.48e-01 |  5.87e-05
        6 |  2.48e-01 |  2.37e-08
        9 |  2.48e-01 |  1.67e-12
Done solving using SVRG in 0.06659603118896484 seconds

found minimizer
 [-1.93296625  0.01182093  3.89796454  1.95714016  0.9914066 ]
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/simulation/poisson_process_simulation.html">Poisson processes simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/simulation/hawkes_simulation.html">Hawkes processes simulation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/inference/hawkes_non_parametric.html">Hawkes non parametric inference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/optimization/stochastic_solver.html">Stochastic solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/optimization/linear_model.html">Generalized linear models</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/misc/time_function.html">Time functions</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Models [<code class="docutils literal"><span class="pre">mlpp.optim.model</span></code>]</a></li>
<li class="toctree-l1"><a class="reference internal" href="prox.html">Proximal operators [<code class="docutils literal"><span class="pre">mlpp.optim.prox</span></code>]</a></li>
<li class="toctree-l1"><a class="reference internal" href="solver.html">Solvers [<code class="docutils literal"><span class="pre">mlpp.optim.solver</span></code>]</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../simu/simu.html">Simulation toolbox [<code class="docutils literal"><span class="pre">mlpp.simulation</span></code>]</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/dev.html">Developer documentation</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../z_tutorials/misc/time_function.html" title="Time functions"
              >previous</a> |
            <a href="model.html" title="Models [mlpp.optim.model]"
              >next</a> |
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/optim/optimization_toolbox.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Emmanuel Bacry, Martin Bompaire, Stephane Gaiffas, Maryan Morel, Søren Poulsen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>