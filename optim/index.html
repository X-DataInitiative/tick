<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Optimization toolbox &#8212; MLPP 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="MLPP 0.1 documentation" href="../index.html" />
    <link rel="next" title="Models [mlpp.optim.model]" href="model.html" />
    <link rel="prev" title="Coefficients simulation" href="../simulation/utilities/coefficients.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          MLPP</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inference/index.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation toolbox [<code class="docutils literal"><span class="pre">mlpp.simulation</span></code>]</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Optimization toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Developer documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Optimization toolbox</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../simulation/utilities/coefficients.html" title="Previous Chapter: Coefficients simulation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Coefficients ...</span>
    </a>
  </li>
  <li>
    <a href="model.html" title="Next Chapter: Models [mlpp.optim.model]"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Models [mlpp.... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/optim/index.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="optimization-toolbox">
<h1>Optimization toolbox<a class="headerlink" href="#optimization-toolbox" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="model.html">Models [<code class="docutils literal"><span class="pre">mlpp.optim.model</span></code>]</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#contents">Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#generalized-linear-models">Generalized linear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#hawkes-model">Hawkes model</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#what-s-under-the-hood">What&#8217;s under the hood?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prox.html">Proximal operators [<code class="docutils literal"><span class="pre">mlpp.optim.prox</span></code>]</a><ul>
<li class="toctree-l2"><a class="reference internal" href="prox.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="prox.html#available-operators">Available operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="prox.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="solver.html">Solvers [<code class="docutils literal"><span class="pre">mlpp.optim.solver</span></code>]</a><ul>
<li class="toctree-l2"><a class="reference internal" href="solver.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="solver.html#batch-solvers">Batch solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="solver.html#stochastic-solvers">Stochastic solvers</a></li>
</ul>
</li>
</ul>
</div>
<p>We are in the following case</p>
<div class="math">
\[\min_x f(x) + g(x)\]</div>
<p>In which <span class="math">\(f\)</span> and <span class="math">\(g\)</span> are usually convex and <span class="math">\(g\)</span> is
prox-capable. Depending on the problem, you might want to use a specific
algorithm to solve it.</p>
<p>In mlpp:</p>
<ul class="simple">
<li>we call <span class="math">\(f\)</span> the <strong>model</strong>. The model gives information about a
statistical model based on the data our problem relies on.
Depending on the case, it gives first order information (loss, gradient) or
second order information (hessian related values).<ul>
<li>linear regression <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.model.ModelLinReg</span></code></li>
<li>logistic regression <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.model.ModelLogReg</span></code></li>
</ul>
</li>
<li>we call <span class="math">\(g\)</span> the <strong>prox</strong>. The prox will make our solution looks like
what we think it should.<ul>
<li>Prox L1 (or lasso) <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.prox.ProxL1</span></code></li>
<li>Prox L2 (or ridge) <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.prox.ProxL2Sq</span></code></li>
</ul>
</li>
<li>we call the algorithm the <strong>solver</strong>. The solver associated the model and
the prox use an algorithm to determine what is the minimizer of our problem.
Examples of solver are SGD (stochastic gradient descent), Fista or SVRG.<ul>
<li>SGD <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.solver.SGD</span></code></li>
<li>Fista <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.solver.Fista</span></code></li>
<li>SVRG <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.solver.SVRG</span></code></li>
</ul>
</li>
</ul>
<p>This allow us to try many different combinations of models, proximal operators
and solvers.</p>
<p>Here is a quick example of finding the result of a logistic regression with a
ridge penalization thanks to SVRG solver:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.model</span> <span class="k">import</span> <span class="n">ModelLogReg</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.solver</span> <span class="k">import</span> <span class="n">SVRG</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.prox</span> <span class="k">import</span> <span class="n">ProxL2Sq</span>
<span class="kn">from</span> <span class="nn">mlpp.simulation</span> <span class="k">import</span> <span class="n">SimuLogReg</span>

<span class="c1"># simulate logistic data</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SimuLogReg</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="c1"># create logistic model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ModelLogReg</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># make model fits the data</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Create the prox L2</span>
<span class="n">l_l2sq</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">7</span>
<span class="n">prox</span> <span class="o">=</span> <span class="n">ProxL2Sq</span><span class="p">(</span><span class="n">l_l2sq</span><span class="p">)</span>

<span class="c1"># Create the solver</span>
<span class="n">svrg</span> <span class="o">=</span> <span class="n">SVRG</span><span class="p">(</span><span class="n">print_every</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Make solver work with our model and prox</span>
<span class="n">svrg</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svrg</span><span class="o">.</span><span class="n">set_prox</span><span class="p">(</span><span class="n">prox</span><span class="p">)</span>

<span class="c1"># Find the solution</span>
<span class="n">minimizer</span> <span class="o">=</span> <span class="n">svrg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">n_coeffs</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">found minimizer</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">minimizer</span><span class="p">)</span>
</pre></div>
</div>
<p>This outputs:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Launching the solver SVRG...
  n_iter  |    obj    |  rel_obj
        0 |  2.57e-01 |  6.29e-01
        3 |  2.48e-01 |  5.87e-05
        6 |  2.48e-01 |  2.37e-08
        9 |  2.48e-01 |  1.67e-12
Done solving using SVRG in 0.06659603118896484 seconds

found minimizer
 [-1.93296625  0.01182093  3.89796454  1.95714016  0.9914066 ]
</pre></div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Emmanuel Bacry, Martin Bompaire, Stephane Gaiffas, Maryan Morel, Søren Poulsen.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.<br/>
    </p>
  </div>
</footer>
  </body>
</html>